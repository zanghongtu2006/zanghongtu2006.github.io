

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Event Notification &mdash; Apache CloudStack 4.13.0.0 文档</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TroubleShooting" href="troubleshooting.html" />
    <link rel="prev" title="Tuning" href="tuning.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="events.html" />

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "adminguide/events"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Apache CloudStack
          

          
          </a>

          
            
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../conceptsandterminology/index.html">CloudStack 概念和术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickinstallationguide/qig.html">快速安装向导</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installguide/index.html">安装指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">升级 CloudStack</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">使用手册</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#user-interface">User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#managing-accounts-users-and-domains">Managing Accounts, Users and Domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#using-projects-to-organize-user-resources">Using Projects to Organize User Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#service-offerings">Service Offerings</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#setting-up-networking-for-users">设置用户网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#working-with-virtual-machines">Working with Virtual Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#working-with-templates">Working with Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#working-with-hosts">Working with Hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#working-with-storage">Working with Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#working-with-system-virtual-machines">Working with System Virtual Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#working-with-usage">Working with Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#managing-networks-and-traffic">Managing Networks and Traffic</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#managing-the-cloud">Managing the Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#system-reliability-and-availability">System Reliability and Availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tuning">Tuning</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#events-and-troubleshooting">Events and Troubleshooting</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="events.html#">Event Notification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="events.html#event-logs">Event Logs</a></li>
<li class="toctree-l4"><a class="reference internal" href="events.html#notification">Notification</a></li>
<li class="toctree-l4"><a class="reference internal" href="events.html#standard-events">Standard Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="events.html#long-running-job-events">Long Running Job Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="events.html#event-log-queries">Event Log Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="events.html#deleting-and-archiving-events-and-alerts">Deleting and Archiving Events and Alerts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html">TroubleShooting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developersguide/index.html">开发者手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">发行版本说明</a></li>
</ul>
<p class="caption"><span class="caption-text">其它:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/api.html">API 文档</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cwiki.apache.org/confluence/display/CLOUDSTACK/Home">Apache CloudStack Wiki</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/">Apache CloudStack web site</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/downloads.html">Apache CloudStack Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/cloudstack">Apache CloudStack on GitHub</a></li>
</ul>
<p class="caption"><span class="caption-text">Pre 4.11 Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-installation.html">安装指南</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-administration.html">管理员手册</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-release-notes.html">发行版本说明</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Apache CloudStack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">使用手册</a> &raquo;</li>
        
      <li>Event Notification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/cloudstack-documentation/blob/4.13.0.0/source/adminguide/events.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="event-notification">
<h1>Event Notification<a class="headerlink" href="events.html#event-notification" title="Permalink to this headline">¶</a></h1>
<p>An event is essentially a significant or meaningful change in the state
of both virtual and physical resources associated with a cloud
environment. Events are used by monitoring systems, usage and billing
systems, or any other event-driven workflow systems to discern a pattern
and make the right business decision. In CloudStack an event could be a
state change of virtual or physical resources, an action performed by an
user (action events), or policy based events (alerts).</p>
<div class="section" id="event-logs">
<h2>Event Logs<a class="headerlink" href="events.html#event-logs" title="Permalink to this headline">¶</a></h2>
<p>There are two types of events logged in the CloudStack Event Log.
Standard events log the success or failure of an event and can be used
to identify jobs or processes that have failed. There are also long
running job events. Events for asynchronous jobs log when a job is
scheduled, when it starts, and when it completes. Other long running
synchronous jobs log when a job starts, and when it completes. Long
running synchronous and asynchronous event logs can be used to gain more
information on the status of a pending job or can be used to identify a
job that is hanging or has not started. The following sections provide
more information on these events..</p>
</div>
<div class="section" id="notification">
<h2>Notification<a class="headerlink" href="events.html#notification" title="Permalink to this headline">¶</a></h2>
<p>Event notification framework provides a means for the 管理服务
components to publish and subscribe to CloudStack events. Event
notification is achieved by implementing the concept of event bus
abstraction in the 管理服务.</p>
<p>A new event for state change, resource state change, is introduced as
part of Event notification framework. Every resource, such as user VM,
volume, NIC, network, public IP, snapshot, and template, is associated
with a state machine and generates events as part of the state change.
That implies that a change in the state of a resource results in a state
change event, and the event is published in the corresponding state
machine on the event bus. All the CloudStack events (alerts, action
events, usage events) and the additional category of resource state
change events, are published on to the events bus.</p>
<div class="section" id="implementations">
<h3>Implementations<a class="headerlink" href="events.html#implementations" title="Permalink to this headline">¶</a></h3>
<p>An event bus is introduced in the
管理服务 that allows the CloudStack components and extension
plug-ins to subscribe to the events by using the Advanced Message
Queuing Protocol (AMQP) client. In CloudStack, a default implementation
of event bus is provided as a plug-in that uses the RabbitMQ AMQP
client. The AMQP client pushes the published events to a compatible AMQP
server. Therefore all the CloudStack events are published to an exchange
in the AMQP server.</p>
<p>Additionally, both an in-memory implementation and an Apache Kafka
implementation are also available.</p>
</div>
<div class="section" id="use-cases">
<h3>Use Cases<a class="headerlink" href="events.html#use-cases" title="Permalink to this headline">¶</a></h3>
<p>The following are some of the use cases:</p>
<ul class="simple">
<li>Usage or Billing Engines: A third-party cloud usage solution can
implement a plug-in that can connects to CloudStack to subscribe to
CloudStack events and generate usage data. The usage data is consumed
by their usage software.</li>
<li>AMQP plug-in can place all the events on the a message queue, then a
AMQP message broker can provide topic-based notification to the
subscribers.</li>
<li>Publish and Subscribe notification service can be implemented as a
pluggable service in CloudStack that can provide rich set of APIs for
event notification, such as topics-based subscription and
notification. Additionally, the pluggable service can deal with
multi-tenancy, authentication, and authorization issues.</li>
</ul>
</div>
<div class="section" id="amqp-configuration">
<h3>AMQP Configuration<a class="headerlink" href="events.html#amqp-configuration" title="Permalink to this headline">¶</a></h3>
<p>As a CloudStack administrator, perform the following one-time
configuration to enable event notification framework. At run time no
changes can control the behaviour.</p>
<ol class="arabic">
<li><p class="first">Create the folder <code class="docutils literal notranslate"><span class="pre">/etc/cloudstack/management/META-INF/cloudstack/core</span></code></p>
</li>
<li><p class="first">Inside that folder, open <code class="docutils literal notranslate"><span class="pre">spring-event-bus-context.xml</span></code>.</p>
</li>
<li><p class="first">Define a bean named <code class="docutils literal notranslate"><span class="pre">eventNotificationBus</span></code> as follows:</p>
<ul>
<li><p class="first">name : Specify a name for the bean.</p>
</li>
<li><p class="first">server : The name or the IP address of the RabbitMQ AMQP server.</p>
</li>
<li><p class="first">port : The port on which RabbitMQ server is running.</p>
</li>
<li><p class="first">username : The username associated with the account to access the
RabbitMQ server.</p>
</li>
<li><p class="first">password : The password associated with the username of the
account to access the RabbitMQ server.</p>
</li>
<li><p class="first">exchange : The exchange name on the RabbitMQ server where
CloudStack events are published.</p>
<p>A sample bean is given below:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">beans</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/beans&quot;</span>
<span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span class="n">xmlns</span><span class="p">:</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/context&quot;</span>
<span class="n">xmlns</span><span class="p">:</span><span class="n">aop</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/aop&quot;</span>
<span class="n">xsi</span><span class="p">:</span><span class="n">schemaLocation</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/beans</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">beans</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">beans</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">aop</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">aop</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">aop</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">context</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">context</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">context</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span><span class="s2">&quot;&gt;</span>
   <span class="o">&lt;</span><span class="n">bean</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;eventNotificationBus&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;org.apache.cloudstack.mom.rabbitmq.RabbitMQEventBus&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;name&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;eventNotificationBus&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;port&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;5672&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;username&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;guest&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;password&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;guest&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exchange&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;cloudstack-events&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">beans</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">eventNotificationBus</span></code> bean represents the
<code class="docutils literal notranslate"><span class="pre">org.apache.cloudstack.mom.rabbitmq.RabbitMQEventBus</span></code> class.</p>
<p>If you want to use encrypted values for the username and password, you have to include a bean to pass those
as variables from a credentials file.</p>
<p>A sample is given below</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">beans</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="n">xmlns</span><span class="p">:</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/context&quot;</span>
       <span class="n">xmlns</span><span class="p">:</span><span class="n">aop</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/aop&quot;</span>
       <span class="n">xsi</span><span class="p">:</span><span class="n">schemaLocation</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/beans</span>
        <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">beans</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">beans</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span>
        <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">aop</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">aop</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">aop</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span>
        <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">context</span>
        <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">context</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">context</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span><span class="s2">&quot;</span>
<span class="o">&gt;</span>

   <span class="o">&lt;</span><span class="n">bean</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;eventNotificationBus&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;org.apache.cloudstack.mom.rabbitmq.RabbitMQEventBus&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;name&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;eventNotificationBus&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;port&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;5672&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;username&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{username}</span><span class="s2">&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;password&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{password}</span><span class="s2">&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exchange&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;cloudstack-events&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>

   <span class="o">&lt;</span><span class="n">bean</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;environmentVariablesConfiguration&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;org.jasypt.encryption.pbe.config.EnvironmentStringPBEConfig&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;algorithm&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;PBEWithMD5AndDES&quot;</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;passwordEnvName&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;APP_ENCRYPTION_PASSWORD&quot;</span> <span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>

   <span class="o">&lt;</span><span class="n">bean</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;configurationEncryptor&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;org.jasypt.encryption.pbe.StandardPBEStringEncryptor&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;config&quot;</span> <span class="n">ref</span><span class="o">=</span><span class="s2">&quot;environmentVariablesConfiguration&quot;</span> <span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>

   <span class="o">&lt;</span><span class="n">bean</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;propertyConfigurer&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;org.jasypt.spring3.properties.EncryptablePropertyPlaceholderConfigurer&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">constructor</span><span class="o">-</span><span class="n">arg</span> <span class="n">ref</span><span class="o">=</span><span class="s2">&quot;configurationEncryptor&quot;</span> <span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;location&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;classpath:/cred.properties&quot;</span> <span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">beans</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Create a new file in the same folder called <code class="docutils literal notranslate"><span class="pre">cred.properties</span></code> and the specify the values for username and password as jascrypt encrypted strings</p>
<p>Sample, with <code class="docutils literal notranslate"><span class="pre">guest</span></code> as values for both fields:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">username</span><span class="o">=</span><span class="n">nh2XrM7jWHMG4VQK18iiBQ</span><span class="o">==</span>
<span class="n">password</span><span class="o">=</span><span class="n">nh2XrM7jWHMG4VQK18iiBQ</span><span class="o">==</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Restart the 管理服务.</p>
</li>
</ol>
</div>
<div class="section" id="kafka-configuration">
<h3>Kafka Configuration<a class="headerlink" href="events.html#kafka-configuration" title="Permalink to this headline">¶</a></h3>
<p>As a CloudStack administrator, perform the following one-time
configuration to enable event notification framework. At run time no
changes can control the behaviour.</p>
<ol class="arabic">
<li><p class="first">Create an appropriate configuration file in <code class="docutils literal notranslate"><span class="pre">/etc/cloudstack/management/kafka.producer.properties</span></code>
which contains valid kafka configuration properties as documented in <a class="reference external" href="http://kafka.apache.org/documentation.html#newproducerconfigs">http://kafka.apache.org/documentation.html#newproducerconfigs</a>
The properties may contain an additional <code class="docutils literal notranslate"><span class="pre">topic</span></code> property which if not provided will default to <code class="docutils literal notranslate"><span class="pre">cloudstack</span></code>.
While <code class="docutils literal notranslate"><span class="pre">key.serializer</span></code> and <code class="docutils literal notranslate"><span class="pre">value.serializer</span></code> are usually required for a producer to correctly start, they may be omitted and
will default to <code class="docutils literal notranslate"><span class="pre">org.apache.kafka.common.serialization.StringSerializer</span></code>.</p>
</li>
<li><p class="first">Create the folder <code class="docutils literal notranslate"><span class="pre">/etc/cloudstack/management/META-INF/cloudstack/core</span></code></p>
</li>
<li><p class="first">Inside that folder, open <code class="docutils literal notranslate"><span class="pre">spring-event-bus-context.xml</span></code>.</p>
</li>
<li><p class="first">Define a bean named <code class="docutils literal notranslate"><span class="pre">eventNotificationBus</span></code> with a single <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute, A sample bean is given below:</p>
<div class="code xml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">beans</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="n">xmlns</span><span class="p">:</span><span class="n">xsi</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="n">xmlns</span><span class="p">:</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/context&quot;</span>
       <span class="n">xmlns</span><span class="p">:</span><span class="n">aop</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/aop&quot;</span>
       <span class="n">xsi</span><span class="p">:</span><span class="n">schemaLocation</span><span class="o">=</span><span class="s2">&quot;http://www.springframework.org/schema/beans</span>
                           <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">beans</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">beans</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span>
                           <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">aop</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">aop</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">aop</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span>
                           <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">context</span>
                           <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">springframework</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">schema</span><span class="o">/</span><span class="n">context</span><span class="o">/</span><span class="n">spring</span><span class="o">-</span><span class="n">context</span><span class="o">-</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xsd</span><span class="s2">&quot;&gt;</span>
   <span class="o">&lt;</span><span class="n">bean</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;eventNotificationBus&quot;</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;org.apache.cloudstack.mom.kafka.KafkaEventBus&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="nb">property</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;name&quot;</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;eventNotificationBus&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">bean</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">beans</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Restart the 管理服务.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="standard-events">
<h2>Standard Events<a class="headerlink" href="events.html#standard-events" title="Permalink to this headline">¶</a></h2>
<p>The events log records three types of standard events.</p>
<ul class="simple">
<li>INFO. This event is generated when an operation has been successfully
performed.</li>
<li>WARN. This event is generated in the following circumstances.<ul>
<li>When a network is disconnected while monitoring a template
download.</li>
<li>When a template download is abandoned.</li>
<li>When an issue on the storage server causes the volumes to fail
over to the mirror storage server.</li>
</ul>
</li>
<li>ERROR. This event is generated when an operation has not been
successfully performed</li>
</ul>
</div>
<div class="section" id="long-running-job-events">
<h2>Long Running Job Events<a class="headerlink" href="events.html#long-running-job-events" title="Permalink to this headline">¶</a></h2>
<p>The events log records three types of standard events.</p>
<ul class="simple">
<li>INFO. This event is generated when an operation has been successfully
performed.</li>
<li>WARN. This event is generated in the following circumstances.<ul>
<li>When a network is disconnected while monitoring a template
download.</li>
<li>When a template download is abandoned.</li>
<li>When an issue on the storage server causes the volumes to fail
over to the mirror storage server.</li>
</ul>
</li>
<li>ERROR. This event is generated when an operation has not been
successfully performed</li>
</ul>
</div>
<div class="section" id="event-log-queries">
<h2>Event Log Queries<a class="headerlink" href="events.html#event-log-queries" title="Permalink to this headline">¶</a></h2>
<p>Database logs can be queried from the user interface. The list of events
captured by the system includes:</p>
<ul class="simple">
<li>Virtual machine creation, deletion, and on-going management
operations</li>
<li>Virtual router creation, deletion, and on-going management operations</li>
<li>Template creation and deletion</li>
<li>Network/load balancer rules creation and deletion</li>
<li>Storage volume creation and deletion</li>
<li>User login and logout</li>
</ul>
</div>
<div class="section" id="deleting-and-archiving-events-and-alerts">
<h2>Deleting and Archiving Events and Alerts<a class="headerlink" href="events.html#deleting-and-archiving-events-and-alerts" title="Permalink to this headline">¶</a></h2>
<p>CloudStack provides you the ability to delete or archive the existing
alerts and events that you no longer want to implement. You can
regularly delete or archive any alerts or events that you cannot, or do
not want to resolve from the database.</p>
<p>You can delete or archive individual alerts or events either directly by
using the Quickview or by using the Details page. If you want to delete
multiple alerts or events at the same time, you can use the respective
context menu. You can delete alerts or events by category for a time
period. For example, you can select categories such as <strong>USER.LOGOUT</strong>,
<strong>VM.DESTROY</strong>, <strong>VM.AG.UPDATE</strong>, <strong>CONFIGURATION.VALUE.EDI</strong>, and so
on. You can also view the number of events or alerts archived or
deleted.</p>
<p>In order to support the delete or archive alerts, the following global
parameters have been added:</p>
<ul class="simple">
<li><strong>alert.purge.delay</strong>: The alerts older than specified number of days
are purged. Set the value to 0 to never purge alerts automatically.</li>
<li><strong>alert.purge.interval</strong>: The interval in seconds to wait before
running the alert purge thread. The default is 86400 seconds (one
day).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Archived alerts or events cannot be viewed in the UI or by using the
API. They are maintained in the database for auditing or compliance
purposes.</p>
</div>
<div class="section" id="permissions">
<h3>Permissions<a class="headerlink" href="events.html#permissions" title="Permalink to this headline">¶</a></h3>
<p>Consider the following:</p>
<ul class="simple">
<li>The root admin can delete or archive one or multiple alerts or
events.</li>
<li>The domain admin or end user can delete or archive one or multiple
events.</li>
</ul>
</div>
<div class="section" id="procedure">
<h3>Procedure<a class="headerlink" href="events.html#procedure" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Log in as administrator to the CloudStack UI.</li>
<li>In the left navigation, click Events.</li>
<li>Perform either of the following:<ul>
<li>To archive events, click Archive Events, and specify event type
and date.</li>
<li>To archive events, click Delete Events, and specify event type and
date.</li>
</ul>
</li>
<li>Click OK.</li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="TroubleShooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tuning.html" class="btn btn-neutral float-left" title="Tuning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Apache Foundation
      
        <span class="commit">
          Revision <code>29a3d9e2</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="http://docs.cloudstack.apache.org/en/master/">master</a></dd>
        
          <dd><a href="../../../index.html">latest</a></dd>
        
          <dd><a href="../../4.13.0.0/index.html">4.13.0.0</a></dd>
        
          <dd><a href="../../4.12.0.0/index.html">4.12.0.0</a></dd>
        
          <dd><a href="../../4.11.3.0/index.html">4.11.3.0</a></dd>
        
          <dd><a href="../../4.11.2.0/index.html">4.11.2.0</a></dd>
        
          <dd><a href="../../4.11.1.0/index.html">4.11.1.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="http://readthedocs.org/projects/cloudstack-documentation/downloads/htmlzip/latest/">html</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://readthedocs.org/projects/cloudstack-documentation/?fromdocs=cloudstack-documentation">Project Home</a>
          </dd>
          <dd>
            <a href="http://readthedocs.org/builds/cloudstack-documentation/?fromdocs=cloudstack-documentation">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>