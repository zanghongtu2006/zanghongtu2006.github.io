

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>小规模部署 &mdash; Apache CloudStack 4.12.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="基础网络和高级网络" href="network_setup.html" />
    <link rel="prev" title="什么是 Apache CloudStack?" href="concepts.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="../../latest/conceptsandterminology/choosing_deployment_architecture.html" />

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "conceptsandterminology/choosing_deployment_architecture"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Apache CloudStack
          

          
          </a>

          
            
            
            
              <div class="version">
                4.12.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CloudStack 概念和术语</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#concepts-and-terminolgy">概念和术语</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#choosing-a-deployment-architecture">架构选型</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="choosing_deployment_architecture.html#">小规模部署</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing_deployment_architecture.html#large-scale-redundant-setup">大规模冗余部署</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing_deployment_architecture.html#separate-storage-network">独立存储网络</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing_deployment_architecture.html#multi-node-management-server">Multi-Node 管理服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing_deployment_architecture.html#multi-site-deployment">Multi-Site Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="choosing_deployment_architecture.html#choosing-a-hypervisor">Hypervisor 选型</a><ul>
<li class="toctree-l4"><a class="reference internal" href="choosing_deployment_architecture.html#hypervisor-support-for-primary-storage">Hypervisor Support for 主存储</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="choosing_deployment_architecture.html#best-practices">最佳实践</a><ul>
<li class="toctree-l4"><a class="reference internal" href="choosing_deployment_architecture.html#process-best-practices">Process 最佳实践</a></li>
<li class="toctree-l4"><a class="reference internal" href="choosing_deployment_architecture.html#setup-best-practices">Setup 最佳实践</a></li>
<li class="toctree-l4"><a class="reference internal" href="choosing_deployment_architecture.html#maintenance-best-practices">Maintenance 最佳实践</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#network-setup">网络配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#storage-setup">存储配置</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../quickinstallationguide/qig.html">快速安装向导</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installguide/index.html">安装指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">升级 CloudStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adminguide/index.html">使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developersguide/index.html">开发者手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">插件使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">发行版本说明</a></li>
</ul>
<p class="caption"><span class="caption-text">其它:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/api.html">API 文档</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cwiki.apache.org/confluence/display/CLOUDSTACK/Home">Apache CloudStack Wiki</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/">Apache CloudStack web site</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/downloads.html">Apache CloudStack Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/cloudstack">Apache CloudStack on GitHub</a></li>
</ul>
<p class="caption"><span class="caption-text">Pre 4.11 Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-installation.html">安装指南</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-administration.html">管理员手册</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-release-notes.html">发行版本说明</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Apache CloudStack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">CloudStack 概念和术语</a> &raquo;</li>
        
      <li>小规模部署</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/cloudstack-documentation/blob/4.12.0.0/source/conceptsandterminology/choosing_deployment_architecture.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>The architecture used in a deployment will vary depending on the size
and purpose of the deployment. This section contains examples of
deployment architecture, including a 小规模部署 useful for
test and trial deployments and a fully-redundant large-scale setup for
production deployments.</p>
<div class="section" id="small-scale-deployment">
<h1>小规模部署<a class="headerlink" href="choosing_deployment_architecture.html#small-scale-deployment" title="Permalink to this headline">¶</a></h1>
<p><img alt="小规模部署" src="../_images/small-scale-deployment.png" /></p>
<p>This diagram illustrates the network architecture of a small-scale
CloudStack deployment.</p>
<ul class="simple">
<li>A firewall provides a connection to the Internet. The firewall is
configured in NAT mode. The firewall forwards HTTP requests and API
calls from the Internet to the 管理服务. The Management
Server resides on the management network.</li>
<li>A layer-2 switch connects all physical servers and storage.</li>
<li>A single NFS server functions as both the primary and secondary
storage.</li>
<li>The 管理服务 is connected to the management network.</li>
</ul>
</div>
<div class="section" id="large-scale-redundant-setup">
<h1>大规模冗余部署<a class="headerlink" href="choosing_deployment_architecture.html#large-scale-redundant-setup" title="Permalink to this headline">¶</a></h1>
<p><img alt="大规模冗余部署" src="../_images/large-scale-redundant-setup.png" /></p>
<p>This diagram illustrates the network architecture of a large-scale
CloudStack deployment.</p>
<ul class="simple">
<li>A layer-3 switching layer is at the core of the data center. A router
redundancy protocol like VRRP should be deployed. Typically high-end
core switches also include firewall modules. Separate firewall
appliances may also be used if the layer-3 switch does not have
integrated firewall capabilities. The firewalls are configured in NAT
mode. The firewalls provide the following functions:<ul>
<li>Forwards HTTP requests and API calls from the Internet to the
管理服务. The 管理服务 resides on the management
network.</li>
<li>When the cloud spans multiple zones, the firewalls should enable
site-to-site VPN such that servers in different zones can directly
reach each other.</li>
</ul>
</li>
<li>A layer-2 access switch layer is established for each pod. Multiple
switches can be stacked to increase port count. In either case,
redundant pairs of layer-2 switches should be deployed.</li>
<li>The 管理服务 cluster (including front-end load balancers,
管理服务 nodes, and the MySQL database) is connected to the
management network through a pair of load balancers.</li>
<li>Secondary storage servers are connected to the management network.</li>
<li>Each pod contains storage and computing servers. Each storage and
computing server should have redundant NICs connected to separate
layer-2 access switches.</li>
</ul>
</div>
<div class="section" id="separate-storage-network">
<h1>独立存储网络<a class="headerlink" href="choosing_deployment_architecture.html#separate-storage-network" title="Permalink to this headline">¶</a></h1>
<p>In the 大规模冗余部署 described in the previous section,
storage traffic can overload the management network. A separate storage
network is optional for deployments. Storage protocols such as iSCSI are
sensitive to network delays. A 独立存储网络 ensures guest
network traffic contention does not impact storage performance.</p>
</div>
<div class="section" id="multi-node-management-server">
<h1>Multi-Node 管理服务<a class="headerlink" href="choosing_deployment_architecture.html#multi-node-management-server" title="Permalink to this headline">¶</a></h1>
<p>The CloudStack 管理服务 is deployed on one or more front-end
servers connected to a single MySQL database. Optionally a pair of
hardware load balancers distributes requests from the web. A backup
management server set may be deployed using MySQL replication at a
remote site to add DR capabilities.</p>
<p><img alt="Multi-Node 管理服务" src="../_images/multi-node-management-server.png" /></p>
<p>The administrator must decide the following.</p>
<ul class="simple">
<li>Whether or not load balancers will be used.</li>
<li>How many Management Servers will be deployed.</li>
<li>Whether MySQL replication will be deployed to enable disaster
recovery.</li>
</ul>
</div>
<div class="section" id="multi-site-deployment">
<h1>Multi-Site Deployment<a class="headerlink" href="choosing_deployment_architecture.html#multi-site-deployment" title="Permalink to this headline">¶</a></h1>
<p>The CloudStack platform scales well into multiple sites through the use
of zones. The following diagram shows an example of a multi-site
deployment.</p>
<p><img alt="Example Of A Multi-Site Deployment" src="../_images/multi-site-deployment.png" /></p>
<p>Data Center 1 houses the primary 管理服务 as well as zone 1.
The MySQL database is replicated in real time to the secondary
管理服务 installation in Data Center 2.</p>
<p><img alt="独立存储网络" src="../_images/separate-storage-network.png" /></p>
<p>This diagram illustrates a setup with a 独立存储网络. Each
server has four NICs, two connected to pod-level network switches and
two connected to storage network switches.</p>
<p>There are two ways to configure the storage network:</p>
<ul class="simple">
<li>Bonded NIC and redundant switches can be deployed for NFS. In NFS
deployments, redundant switches and bonded NICs still result in one
network (one CIDR block+ default gateway address).</li>
<li>iSCSI can take advantage of two 独立存储网络s (two CIDR
blocks each with its own default gateway). Multipath iSCSI client can
failover and load balance between 独立存储网络s.</li>
</ul>
<p><img alt="NIC Bonding And Multipath I/O" src="../_images/nic-bonding-and-multipath-io.png" /></p>
<p>This diagram illustrates the differences between NIC bonding and
Multipath I/O (MPIO). NIC bonding configuration involves only one
network. MPIO involves two separate networks.</p>
</div>
<div class="section" id="choosing-a-hypervisor">
<h1>Hypervisor 选型<a class="headerlink" href="choosing_deployment_architecture.html#choosing-a-hypervisor" title="Permalink to this headline">¶</a></h1>
<p>CloudStack supports many popular hypervisors. Your cloud can consist
entirely of hosts running a single hypervisor, or you can use multiple
hypervisors. Each cluster of hosts must run the same hypervisor.</p>
<p>You might already have an installed base of nodes running a particular
hypervisor, in which case, your choice of hypervisor has already been
made. If you are starting from scratch, you need to decide what
hypervisor software best suits your needs. A discussion of the relative
advantages of each hypervisor is outside the scope of our documentation.
However, it will help you to know which features of each hypervisor are
supported by CloudStack. The following table provides this information.</p>
<table border="1" class="table-striped table-bordered table-hover docutils">
<colgroup>
<col width="41%" />
<col width="13%" />
<col width="12%" />
<col width="10%" />
<col width="6%" />
<col width="10%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Feature</th>
<th class="head">XenServer</th>
<th class="head">vSphere</th>
<th class="head"><blockquote class="first">
<div>KVM</div></blockquote>
<p class="last">(RHEL)</p>
</th>
<th class="head">LXC</th>
<th class="head">HyperV</th>
<th class="head">Bare
Metal</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>网络限流</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
<td>?</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>安全 groups in zones that use
basic networking</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>?</td>
<td>No</td>
</tr>
<tr class="row-even"><td>iSCSI</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>FibreChannel</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Local Disk</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>HA</td>
<td>Yes</td>
<td>Yes
(Native)</td>
<td>Yes</td>
<td>?</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Snapshots of local disk</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>?</td>
<td>?</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Local disk as data disk</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Work load balancing</td>
<td>No</td>
<td>DRS</td>
<td>No</td>
<td>No</td>
<td>?</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>Manual live migration of VMs from
host to host</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>?</td>
<td>Yes</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td>Conserve management traffic IP
address by using link local
network to communicate with
virtual router</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>?</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<div class="section" id="hypervisor-support-for-primary-storage">
<h2>Hypervisor Support for 主存储<a class="headerlink" href="choosing_deployment_architecture.html#hypervisor-support-for-primary-storage" title="Permalink to this headline">¶</a></h2>
<p>The following table shows storage options and parameters for different
hypervisors.</p>
<table border="1" class="table-striped table-bordered table-hover docutils">
<colgroup>
<col width="33%" />
<col width="13%" />
<col width="15%" />
<col width="16%" />
<col width="16%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">主存储 Type</th>
<th class="head">XenServer</th>
<th class="head">vSphere</th>
<th class="head">KVM - RHEL</th>
<th class="head">LXC</th>
<th class="head">HyperV</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Format for Disks, 模板,
and Snapshots</td>
<td>VHD</td>
<td>VMDK</td>
<td>QCOW2</td>
<td>&#160;</td>
<td>VHD</td>
</tr>
<tr class="row-odd"><td>iSCSI support</td>
<td>CLVM</td>
<td>VMFS</td>
<td>Yes via Shared
Mountpoint</td>
<td>Yes via Shared
Mountpoint</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Fiber Channel support</td>
<td>Yes, Via
existing SR</td>
<td>VMFS</td>
<td>Yes via Shared
Mountpoint</td>
<td>Yes via Shared
Mountpoint</td>
<td>No</td>
</tr>
<tr class="row-odd"><td>NFS support</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="row-even"><td>Local storage support</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>Storage over-provisioning</td>
<td>NFS</td>
<td>NFS and iSCSI</td>
<td>NFS</td>
<td>&#160;</td>
<td>No</td>
</tr>
<tr class="row-even"><td>SMB/CIFS</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
</tr>
</tbody>
</table>
<p>XenServer uses a clustered LVM system to store VM images on iSCSI and
Fiber Channel volumes and does not support over-provisioning in the
hypervisor. The storage server itself, however, can support
thin-provisioning. As a result the CloudStack can still support storage
over-provisioning by running on thin-provisioned storage volumes.</p>
<p>KVM supports “Shared Mountpoint” storage. A shared mountpoint is a file
system path local to each server in a given cluster. The path must be
the same across all Hosts in the cluster, for example /mnt/primary1.
This shared mountpoint is assumed to be a clustered filesystem such as
OCFS2. In this case the CloudStack does not attempt to mount or unmount
the storage as is done with NFS. The CloudStack requires that the
administrator insure that the storage is available</p>
<p>With NFS storage, CloudStack manages the overprovisioning. In this case
the global configuration parameter storage.overprovisioning.factor
controls the degree of overprovisioning. This is independent of
hypervisor type.</p>
<p>Local storage is an option for primary storage for vSphere, XenServer,
and KVM. When the local disk option is enabled, a local disk storage
pool is automatically created on each host. To use local storage for the
System Virtual Machines (such as the 虚拟路由器), set
system.vm.use.local.storage to true in global configuration.</p>
<p>CloudStack supports multiple primary storage pools in a 集群. For
example, you could provision 2 NFS servers in primary storage. Or you
could provision 1 iSCSI LUN initially and then add a second iSCSI LUN
when the first approaches capacity.</p>
</div>
</div>
<div class="section" id="best-practices">
<h1>最佳实践<a class="headerlink" href="choosing_deployment_architecture.html#best-practices" title="Permalink to this headline">¶</a></h1>
<p>Deploying a cloud is challenging. There are many different technology
choices to make, and CloudStack is flexible enough in its configuration
that there are many possible ways to combine and configure the chosen
technology. This section contains suggestions and requirements about
cloud deployments.</p>
<p>These should be treated as suggestions and not absolutes. However, we do
encourage anyone planning to build a cloud outside of these guidelines
to seek guidance and advice on the project mailing lists.</p>
<div class="section" id="process-best-practices">
<h2>Process 最佳实践<a class="headerlink" href="choosing_deployment_architecture.html#process-best-practices" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>A staging system that models the production environment is strongly
advised. It is critical if customizations have been applied to
CloudStack.</li>
<li>Allow adequate time for installation, a beta, and learning the
system. Installs with basic networking can be done in hours. Installs
with advanced networking usually take several days for the first
attempt, with complicated installations taking longer. For a full
production system, allow at least 4-8 weeks for a beta to work
through all of the integration issues. You can get help from fellow
users on the cloudstack-users mailing list.</li>
</ul>
</div>
<div class="section" id="setup-best-practices">
<h2>Setup 最佳实践<a class="headerlink" href="choosing_deployment_architecture.html#setup-best-practices" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Each host should be configured to accept connections only from
well-known entities such as the CloudStack 管理服务 or your
network monitoring software.</li>
<li>Use multiple clusters per pod if you need to achieve a certain switch
density.</li>
<li>Primary storage mountpoints or LUNs should not exceed 6 TB in size.
It is better to have multiple smaller primary storage elements per
cluster than one large one.</li>
<li>When exporting shares on primary storage, avoid data loss by
restricting the range of IP addresses that can access the storage.
See “Linux NFS on Local Disks and DAS” or “Linux NFS on iSCSI”.</li>
<li>NIC bonding is straightforward to implement and provides increased
reliability.</li>
<li>10G networks are generally recommended for storage access when larger
servers that can support relatively more VMs are used.</li>
<li>Host capacity should generally be modeled in terms of RAM for the
guests. Storage and CPU may be overprovisioned. RAM may not. RAM is
usually the limiting factor in capacity designs.</li>
<li>(XenServer) Configure the XenServer dom0 settings to allocate more
memory to dom0. This can enable XenServer to handle larger numbers of
virtual machines. We recommend 2940 MB of RAM for XenServer dom0. For
instructions on how to do this, see
<a class="reference external" href="http://support.citrix.com/article/CTX126531">http://support.citrix.com/article/CTX126531</a>.
The article refers to XenServer 5.6, but the same information applies
to XenServer 6.0.</li>
</ul>
</div>
<div class="section" id="maintenance-best-practices">
<h2>Maintenance 最佳实践<a class="headerlink" href="choosing_deployment_architecture.html#maintenance-best-practices" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Monitor host disk space. Many host failures occur because the host’s
root disk fills up from logs that were not rotated adequately.</li>
<li>Monitor the total number of VM instances in each cluster, and disable
allocation to the cluster if the total is approaching the maximum
that the hypervisor can handle. Be sure to leave a safety margin to
allow for the possibility of one or more hosts failing, which would
increase the VM load on the other hosts as the VMs are redeployed.
Consult the documentation for your chosen hypervisor to find the
maximum permitted number of VMs per host, then use CloudStack global
configuration settings to set this as the default limit. Monitor the
VM activity in each cluster and keep the total number of VMs below a
safe level that allows for the occasional host failure. For example,
if there are N hosts in the cluster, and you want to allow for one
host in the cluster to be down at any given time, the total number of
VM instances you can permit in the cluster is at most (N-1) *
(per-host-limit). Once a cluster reaches this number of VMs, use the
CloudStack UI to disable allocation to the cluster.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The lack of up-do-date hotfixes can lead to data corruption and lost VMs.</p>
</div>
<p>Be sure all the hotfixes provided by the hypervisor vendor are applied. Track
the release of hypervisor patches through your hypervisor vendor’s support
channel, and apply patches as soon as possible after they are released.
CloudStack will not track or notify you of required hypervisor patches. It is
essential that your hosts are completely up to date with the provided
hypervisor patches. The hypervisor vendor is likely to refuse to support any
system that is not up to date with patches.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="network_setup.html" class="btn btn-neutral float-right" title="基础网络和高级网络" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="concepts.html" class="btn btn-neutral float-left" title="什么是 Apache CloudStack?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Apache Foundation
      
        <span class="commit">
          Revision <code>af137188</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 4.12.0.0
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="http://docs.cloudstack.apache.org/en/master/">master</a></dd>
        
          <dd><a href="../../../index.html">latest</a></dd>
        
          <dd><a href="../../4.13.0.0/index.html">4.13.0.0</a></dd>
        
          <dd><a href="../index.html">4.12.0.0</a></dd>
        
          <dd><a href="../../4.11.3.0/index.html">4.11.3.0</a></dd>
        
          <dd><a href="../../4.11.2.0/index.html">4.11.2.0</a></dd>
        
          <dd><a href="../../4.11.1.0/index.html">4.11.1.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="http://readthedocs.org/projects/cloudstack-documentation/downloads/htmlzip/4.12.0.0/">html</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://readthedocs.org/projects/cloudstack-documentation/?fromdocs=cloudstack-documentation">Project Home</a>
          </dd>
          <dd>
            <a href="http://readthedocs.org/builds/cloudstack-documentation/?fromdocs=cloudstack-documentation">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>