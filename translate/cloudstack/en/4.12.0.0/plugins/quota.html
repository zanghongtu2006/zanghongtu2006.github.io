

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quota Plugin &mdash; Apache CloudStack 4.12.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="发行版本说明" href="../releasenotes/index.html" />
    <link rel="prev" title="IPv6 Support in CloudStack" href="ipv6.html" /> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="../../latest/plugins/quota.html" />

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="../_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "plugins/quota"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Apache CloudStack
          

          
          </a>

          
            
            
            
              <div class="version">
                4.12.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../conceptsandterminology/index.html">CloudStack 概念和术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickinstallationguide/qig.html">快速安装向导</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installguide/index.html">安装指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">升级 CloudStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adminguide/index.html">使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developersguide/index.html">开发者手册</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">插件使用手册</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cloudian-connector.html">The Cloudian Connector Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="nicira-plugin.html">The Nicira NVP Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="nuage-plugin.html">The Nuage VSP Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="vxlan.html">The VXLAN Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="ovs-plugin.html">The OVS Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipv6.html">IPv6 Support in CloudStack</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="quota.html#">Quota Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quota.html#enabling-the-quota-service">Enabling the Quota Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="quota.html#quota-tariff">Quota Tariff</a></li>
<li class="toctree-l3"><a class="reference internal" href="quota.html#quota-credits">Quota Credits</a></li>
<li class="toctree-l3"><a class="reference internal" href="quota.html#quota-balance">Quota Balance</a></li>
<li class="toctree-l3"><a class="reference internal" href="quota.html#quota-statement">Quota Statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="quota.html#quota-monthly-statement">Quota Monthly Statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="quota.html#quota-alert-management">Quota Alert Management</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">发行版本说明</a></li>
</ul>
<p class="caption"><span class="caption-text">其它:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/api.html">API 文档</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cwiki.apache.org/confluence/display/CLOUDSTACK/Home">Apache CloudStack Wiki</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/">Apache CloudStack web site</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cloudstack.apache.org/downloads.html">Apache CloudStack Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/apache/cloudstack">Apache CloudStack on GitHub</a></li>
</ul>
<p class="caption"><span class="caption-text">Pre 4.11 Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-installation.html">安装指南</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-administration.html">管理员手册</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../projects/cloudstack-release-notes.html">发行版本说明</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Apache CloudStack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">插件使用手册</a> &raquo;</li>
        
      <li>Quota Plugin</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/apache/cloudstack-documentation/blob/4.12.0.0/source/plugins/quota.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quota-plugin">
<h1>Quota Plugin<a class="headerlink" href="quota.html#quota-plugin" title="Permalink to this headline">¶</a></h1>
<p>Quota service, while allowing for scalability, will make sure that the cloud is
not exploited by attacks, careless use and program errors. To address this
problem, employ the quota-enforcement service that allows resource
usage within certain bounds as defined by policies and available quotas for
various entities. Quota service extends the functionality of usage server to
provide a measurement for the resources used by the accounts and domains using a
common unit referred to as cloud currency in this document. It can be configured
to ensure that your usage won’t exceed the budget allocated to accounts/domain
in cloud currency. It will let user know how much of the cloud resources he is
using. It will help the cloud admins, if they want, to ensure that a user does
not go beyond his allocated quota. Per usage cycle if an account is found to be
exceeding its quota then it is locked. Locking an account means that it will not
be able to initiate a new resource allocation request, whether it is more
storage or an additional ip. To unlock an account you need to add more credit to it.
In case you want the locking to be disabled on global or on account scope those
provisions are also provided. Needless to say quota service as well as any action
on the account is configurable.</p>
<div class="section" id="enabling-the-quota-service">
<h2>Enabling the Quota Service<a class="headerlink" href="quota.html#enabling-the-quota-service" title="Permalink to this headline">¶</a></h2>
<p>Before installing and configuring the quota service you need to make sure that
the Usage Server has been installed. This requires extra steps beyond just
installing the CloudStack software. See Installing the Usage Server (Optional)
in the Advanced 安装指南.</p>
<ol class="arabic simple">
<li>enable.usage.server: Set to true to enable usage server.</li>
</ol>
<p>The quota plugin is disabled by default. To enable it goto Global Settings and
set the following global configuration to true:</p>
<ol class="arabic simple">
<li>quota.enable.service</li>
</ol>
<p>By default Quota service does not lock the accounts that have exceeded the quota
usage. To enable quota service to lock accounts set the following global
configuration to true:</p>
<ol class="arabic simple">
<li>quota.enable.enforcement</li>
</ol>
<p>The other configurations that are there for quota service are as:</p>
<ol class="arabic simple">
<li>quota.currency.symbol : The symbol that is used before any currency
figure in various quota forms and reports.</li>
<li>quota.usage.smtp.host: Quota SMTP host for sending quota alerts.</li>
<li>quota.usage.smtp.port: Quota SMTP port.</li>
<li>quota.usage.smtp.user: Quota SMTP user.</li>
<li>quota.usage.smtp.password: Quota SMTP password.</li>
<li>quota.usage.smtp.sender: Quota SMTP alert sender email address.</li>
<li>quota.usage.smtp.useAuth: If true, use secure SMTP authentication when sending emails.</li>
<li>quota.usage.smtp.connection.timeout: Quota SMTP server connection timeout duration.</li>
</ol>
<p>There are several configuration variables that are inherited from usage server,
these are listed below:</p>
<ol class="arabic simple">
<li>usage.aggregation.timezone</li>
</ol>
<p>All these are described in details in Usage Server documentation.</p>
<p>Restart the 管理服务 and  the Usage Server to enable the set configuration
values.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service</span> <span class="n">cloudstack</span><span class="o">-</span><span class="n">management</span> <span class="n">restart</span>
<span class="n">service</span> <span class="n">cloudstack</span><span class="o">-</span><span class="n">usage</span> <span class="n">restart</span>
</pre></div>
</div>
<p>Once the quota service is running it will calculate the quota balance for each account.
The quota usage is calculated as per the quota tariff provided by the site administrator.</p>
</div>
<div class="section" id="quota-tariff">
<h2>Quota Tariff<a class="headerlink" href="quota.html#quota-tariff" title="Permalink to this headline">¶</a></h2>
<p>The following table shows all quota types for which you can specify tariff.</p>
<table border="1" class="table-striped table-bordered table-hover docutils">
<colgroup>
<col width="23%" />
<col width="44%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type ID</th>
<th class="head">Type Name</th>
<th class="head">Tariff Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>RUNNING_VM</td>
<td>One month of running
Compute-Month</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>ALLOCATED_VM</td>
<td>One month of allocated
VM</td>
</tr>
<tr class="row-even"><td>3</td>
<td>IP_ADDRESS</td>
<td>Quota for a month of
allocated IP</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>NETWORK_BYTES_SENT</td>
<td>Quota for 1GB bytes sent</td>
</tr>
<tr class="row-even"><td>5</td>
<td>NETWORK_BYTES_RECEIVED</td>
<td>Quota for 1GB bytes sent</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>VOLUME</td>
<td>Quota for 1 GB of
Volume use for a month</td>
</tr>
<tr class="row-even"><td>7</td>
<td>TEMPLATE</td>
<td>Quota for 1 GB of
Template use for a month</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>ISO</td>
<td>Quota for 1 GB of
ISO use for a month</td>
</tr>
<tr class="row-even"><td>9</td>
<td>SNAPSHOT</td>
<td>Quota for 1 GB of
SNAPSHOT use for a month</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>LOAD_BALANCER_POLICY</td>
<td>Quota for load balancer
policy month</td>
</tr>
<tr class="row-even"><td>12</td>
<td>PORT_FORWARDING_RULE</td>
<td>Quota for port forwarding
policy month</td>
</tr>
<tr class="row-odd"><td>13</td>
<td>NETWORK_OFFERING</td>
<td>Quota for network
Offering for a month</td>
</tr>
<tr class="row-even"><td>14</td>
<td>VPN_USERS</td>
<td>Quota for VPN usage
for a month</td>
</tr>
<tr class="row-odd"><td>15</td>
<td>CPU_CLOCK_RATE</td>
<td>The tariff for using
1 CPU i100 MHz clock</td>
</tr>
<tr class="row-even"><td>16</td>
<td>CPU_NUMBER</td>
<td>The quota tariff for
using 1 virtual CPU.</td>
</tr>
<tr class="row-odd"><td>17</td>
<td>MEMORY</td>
<td>The quota tariff for
using 1MB RAM size.</td>
</tr>
</tbody>
</table>
<p>The quota tariff can be listed using listQuotaTariff API.</p>
<p>quotaTariff: Lists all quota tariff plans</p>
<p>The tariff for each of the above can be set by using the updateQuotaTariff API.</p>
</div>
<div class="section" id="quota-credits">
<h2>Quota Credits<a class="headerlink" href="quota.html#quota-credits" title="Permalink to this headline">¶</a></h2>
<p>The quota credit (quotaCredit) API lets you add or remove quota currency credits to
an account. With this API you can also control the quota enforcement policy at
account level. This will enable you to have some accounts where the quota policy is
not enforced. The overall quota enforcement is controlled by the quota.enable.enforcement
global setting.</p>
<p>In addition to above the quota API lets you can fine tune the alert generation by specifying
the quota threshold for each account. If not explictly stated, the threshold is taken as 80%
of the last deposit.</p>
</div>
<div class="section" id="quota-balance">
<h2>Quota Balance<a class="headerlink" href="quota.html#quota-balance" title="Permalink to this headline">¶</a></h2>
<p>Quota balance API states the start balance and end balance(optional) from a start date
to end date (optional).</p>
</div>
<div class="section" id="quota-statement">
<h2>Quota Statement<a class="headerlink" href="quota.html#quota-statement" title="Permalink to this headline">¶</a></h2>
<p>Quota statement for a period consist of the quota usage under various quota types for
the given period from a start date to an end date.</p>
</div>
<div class="section" id="quota-monthly-statement">
<h2>Quota Monthly Statement<a class="headerlink" href="quota.html#quota-monthly-statement" title="Permalink to this headline">¶</a></h2>
<p>Quota service emails the monthly quota statement for the last month at the beginning of
each month. For this service to work properly you need to ensure that the usage server
is running.</p>
</div>
<div class="section" id="quota-alert-management">
<h2>Quota Alert Management<a class="headerlink" href="quota.html#quota-alert-management" title="Permalink to this headline">¶</a></h2>
<p>Quota module also provides APIs to customize various email templates that are used to
alert account owners about quota going down below threshold and quota getting over.</p>
<p>All the above functionality is also available via quota UI plugin.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../releasenotes/index.html" class="btn btn-neutral float-right" title="发行版本说明" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ipv6.html" class="btn btn-neutral float-left" title="IPv6 Support in CloudStack" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Apache Foundation
      
        <span class="commit">
          Revision <code>af137188</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 4.12.0.0
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="http://docs.cloudstack.apache.org/en/master/">master</a></dd>
        
          <dd><a href="../../../index.html">latest</a></dd>
        
          <dd><a href="../../4.13.0.0/index.html">4.13.0.0</a></dd>
        
          <dd><a href="../index.html">4.12.0.0</a></dd>
        
          <dd><a href="../../4.11.3.0/index.html">4.11.3.0</a></dd>
        
          <dd><a href="../../4.11.2.0/index.html">4.11.2.0</a></dd>
        
          <dd><a href="../../4.11.1.0/index.html">4.11.1.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="http://readthedocs.org/projects/cloudstack-documentation/downloads/htmlzip/4.12.0.0/">html</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://readthedocs.org/projects/cloudstack-documentation/?fromdocs=cloudstack-documentation">Project Home</a>
          </dd>
          <dd>
            <a href="http://readthedocs.org/builds/cloudstack-documentation/?fromdocs=cloudstack-documentation">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>