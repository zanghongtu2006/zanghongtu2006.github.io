---
title: "源码编译安装CloudStack 4.2"
date: "2014-12-15 18:09:25"
slug: "e6-ba-90-e7-a0-81-e7-bc-96-e8-af-91-e5-ae-89-e8-a3-85cloudstack-4-2"
layout: "post"
categories: ["CloudStack"]
tags: []
---
基于CentOS 6.4安装CloudStack

# 环境配置

[codesyntax lang="bash"]

```
# yum -y update
# yum -y upgrade
```

[/codesyntax]
 
安装NTP，jdk 1.7， tomcat 6， mysql，git等服务
[codesyntax lang="bash"]

```
# yum -y install ntp
# yum -y install java-1.7.0-openjdk-devel
# wget https://archive.apache.org/dist/tomcat/tomcat-6/v6.0.35/bin/apache-tomcat-6.0.35.tar.gz
# tar xzvf apache-tomcat-6.0.35.tar.gz -C /usr/local
# yum -y install mysql mysql-server
# yum -y install git
```

[/codesyntax]
编辑/etc/profile.d/tomcat.sh，写入以下内容
[codesyntax lang="text"]

```
export CATALINA_BASE=/usr/local/apache-tomcat-6.0.35
export CATALINA_HOME=/usr/local/apache-tomcat-6.0.35
```

[/codesyntax]
 
安装maven 3.0.5
[codesyntax lang="bash"]

```
# wget http://mirror.cc.columbia.edu/pub/software/apache/maven/maven-3/3.0.5/binaries/apache-maven-3.0.5-bin.tar.gz
# tar xzf apache-maven-3.0.5-bin.tar.gz -C /usr/local
# cd /usr/local
# ln -s apache-maven-3.0.5 maven
```

[/codesyntax]
 
配置maven服务，编辑/etc/profile.d/maven.sh 文件，写入以下内容
[codesyntax lang="text"]

```
export M2_HOME=/usr/local/maven
export PATH=${M2_HOME}/bin:${PATH}
```

[/codesyntax]
 
登出，再重新登入，查看maven版本
[codesyntax lang="bash"]

```
# mvn --version
Apache Maven 3.0.5 (r01de14724cdef164cd33c7c8c2fe155faf9602da; 2013-02-19 21:51:28+0800)
Maven home: /usr/local/maven
Java version: 1.7.0_71, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.71.x86_64/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "2.6.32-358.el6.x86_64", arch: "amd64", family: "unix
```

[/codesyntax]
 
安装python管理工具
[codesyntax lang="bash"]

```
# yum -y install python-setuptools
```

[/codesyntax]
 
安装epel 源
[codesyntax lang="bash"]

```
# cd /tmp
# wget http://mirror-fpt-telecom.fpt.net/fedora/epel/6/i386/epel-release-6-8.noarch.rpm
# rpm -ivh epel-release-6-8.noarch.rpm
```

[/codesyntax]
 
更新源并安装python-pip
[codesyntax lang="bash"]

```
# yum update
# yum -y install python-pip
```

[/codesyntax]
 
安装mkisofs
[codesyntax lang="bash"]

```
# yum -y install genisoimage
```

[/codesyntax]

# 源码安装

git获取4.2源码
[codesyntax lang="bash"]

```
# git clone https://git-wip-us.apache.org/repos/asf/cloudstack.git
# git checkout 4.2
```

[/codesyntax]
编译安装CloudStack
[codesyntax lang="bash"]

```
# mvn -Pdeveloper,systemvm clean install
```

[/codesyntax]
提示：如果想要跳过单元测试，使用-DskipTests 而不要使用-Dmaven.test.skip=true，后者会中断编译。
设置utils/conf/db.properties，如果不需要修改DB配置，则默认即可
初始化DB并运行CloudStack
[codesyntax lang="bash"]

```
# mvn -P developer -pl developer -Ddeploydb
# mvn -pl :cloud-client-ui jetty:run
```

[/codesyntax]
成功启动，可以在[http://localhost:8080/client/](http://localhost:8080/client/ "http://localhost:8080/client/")中查看UI
如果启用了防火墙，则需要在防火墙上开启以下端口： 8080, 8250, and 9090
