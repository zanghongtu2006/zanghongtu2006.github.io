---
title: "XenServer VM物理CPU使用策略"
date: "2014-08-05 17:36:36"
slug: "xenserver-vm-e7-89-a9-e7-90-86cpu-e4-bd-bf-e7-94-a8-e7-ad-96-e7-95-a5"
layout: "post"
categories: ["IaaS"]
tags: ["xenserver", "CPU使用策略"]
---
首先，我们先来看看XenServer中Socket、Core、以及超线程后的核心之间在XenServer中CPU的排序关系，请参考下表：
[![QQ图片20140805173403](/assets/images/2014/08/QQ图片20140805173403-300x78.jpg)](/assets/images/2014/08/QQ图片20140805173403.jpg)
上表反应了XenServer中CPU的排序规则。
1、指定特定的VM使用指定的物理CPU可以使用命令：
[root@xenserver ~]# xe vm-param-set uuid= VCPUs-params:mask=1,3,7
该命令用于设置特定UUID的VM使用物理CPU排序中的第1,3,7个CPU
2、设置VM中CPU的权重
[root@xenserver ~]# xe vm-param-set uuid= VCPUs-params:weight=512
该命令设置vCPU的权重为512，默认dom0权重为256，权重决定VM在CPU时间片中所占比例，权重范围从0到65535
3、设置VM最大CPU使用率
[root@xenserver ~]# xe vm-param-set uuid= VCPUs-params:cap=80
该命令用户设置VM最大可以使用的CPU为单个CPU的80%，设置为100，则为1个物理CPU的，设置为80，则只能使用一个物理CPU的80%性能，设置为400，则表示最大可以使用4个物理CPU。默认为0，不限制。
转自：http://sunyu.blog.51cto.com/744725/722570
